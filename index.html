<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø­Ø±Ùƒ Ø¨Ø­Ø« Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</title>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
  body { font-family:'Cairo',sans-serif;background:#f4f6f5;margin:0;padding:0;}
  .school-name{text-align:center;padding:25px 0 10px;font-size:1.6rem;font-weight:800;color:#0d5e3a;}
  header{background:linear-gradient(135deg,#0d5e3a,#15a062,#d4a21e);color:#fff;text-align:center;padding:60px 15px 70px;border-bottom:6px solid #d4a21e;}
  header h1{margin:0;font-size:2.3rem;font-weight:800;}
  header p{max-width:700px;margin:10px auto;}
  .footer-labels{margin-top:35px;display:flex;justify-content:space-between;padding:0 25px;}
  .footer-labels div{background:rgba(0,0,0,0.18);padding:8px 14px;border-radius:8px;color:#fff;}
  .school-director{text-align:center;margin:30px 0;font-weight:800;color:#0d5e3a;}
  .search-box{max-width:900px;margin:20px auto;background:#fff;padding:18px;border-radius:12px;border-right:4px solid #0d5e3a;}
  .search-row{display:flex;gap:10px;flex-wrap:wrap;}
  select,input{padding:10px;font-size:1rem;border-radius:8px;}
  select{border:2px solid #0d5e3a;font-weight:600;color:#0d5e3a;}
  input{flex:1;border:2px solid #d4a21e;}
  button{padding:10px 20px;background:#0d5e3a;color:#fff;border:none;border-radius:8px;font-weight:700;cursor:pointer;}
  .suggestions{background:#fff;margin-top:8px;border-radius:8px;display:none;max-height:250px;overflow:auto;border:1px solid #eee;}
  .suggestion-item{padding:10px;border-bottom:1px solid #eee;cursor:pointer;}
  .suggestion-item:hover{background:#f9fafb;}
  .results{max-width:900px;margin:10px auto;}
  .result-item{padding:12px;background:#fff;border-radius:10px;border-right:4px solid #0d5e3a;margin-bottom:10px;cursor:pointer;}
  .video-player{max-width:900px;margin:20px auto;background:#fff;padding:15px;border-radius:12px;display:none;}
  iframe{width:100%;height:320px;border-radius:10px;}
</style>
</head>

<body>

<div class="school-name">Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø´ÙˆÙƒØ§Ù†ÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</div>

<header>
  <h1>Ù…Ø­Ø±Ùƒ Ø¨Ø­Ø« Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h1>
  <p>Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ Ø¹Ù† Ø¯Ø±ÙˆØ³ Ø§Ù„ØµÙÙˆÙ (Ø«Ø§Ù„Ø« â€“ Ø±Ø§Ø¨Ø¹ â€“ Ø®Ø§Ù…Ø³ â€“ Ø³Ø§Ø¯Ø³) <br> Ù„Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„ â€“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©.</p>

  <div class="footer-labels">
    <div>ÙÙƒØ±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ / Ø¹Ø²Ø§Ù… Ø§Ù„Ù„Ø°ÙŠØ°</div>
    <div>Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø£Ø³ØªØ§Ø° / Ù…Ù‚Ø±Ù† Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</div>
  </div>
</header>

<div class="school-director">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø§Ù„Ø£Ø³ØªØ§Ø° ØªÙˆÙÙŠÙ‚ Ø§Ù„Ø¹Ù‚ÙŠÙ„ÙŠ</div>

<div class="search-box">
  <div class="search-row">

    <select id="gradeSelect">
      <option value="">Ø§Ù„ØµÙ</option>
      <option value="3">Ø«Ø§Ù„Ø«</option>
      <option value="4">Ø±Ø§Ø¨Ø¹</option>
      <option value="5">Ø®Ø§Ù…Ø³</option>
      <option value="6">Ø³Ø§Ø¯Ø³</option>
    </select>

    <select id="subjectSelect">
      <option value="">Ø§Ù„Ù…Ø§Ø¯Ø©</option>
      <option value="Ù„ØºØªÙŠ">Ù„ØºØªÙŠ</option>
      <option value="Ø¹Ù„ÙˆÙ…">Ø¹Ù„ÙˆÙ…</option>
      <option value="Ø±ÙŠØ§Ø¶ÙŠØ§Øª">Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
      <option value="Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ">Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</option>
    </select>

    <input id="searchInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯Ø±Ø³â€¦">
    <button id="searchBtn">Ø¨Ø­Ø«</button>

  </div>

  <div id="suggestions" class="suggestions"></div>
</div>

<div id="resultsList" class="results"></div>

<div id="videoPlayer" class="video-player">
  <h2 id="videoTitle"></h2>
  <iframe id="videoFrame" allowfullscreen></iframe>
</div>

<script>
/*  ğŸ”¥ Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ  */
const API_KEY = "AIzaSyDBU4LwwwsEV5tuJqXjvhYp1NRobLR011I";

/*  Ù‚Ù†Ø§Ø© Ø¹ÙŠÙ† Ø§Ù„Ø±Ø³Ù…ÙŠØ©  */
const CHANNEL_ID = "UCndb1LGM5oQJVhjh2NViU5g";

const gradeSelect = document.getElementById("gradeSelect");
const subjectSelect = document.getElementById("subjectSelect");
const searchInput = document.getElementById("searchInput");
const searchBtn = document.getElementById("searchBtn");
const suggestions = document.getElementById("suggestions");
const resultsList = document.getElementById("resultsList");
const videoPlayer = document.getElementById("videoPlayer");
const videoTitle = document.getElementById("videoTitle");
const videoFrame = document.getElementById("videoFrame");

/* ÙÙ„ØªØ±Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ù…Ù†ÙˆØ¹Ø© (Ù…ØªÙˆØ³Ø· + Ø«Ø§Ù†ÙˆÙŠ + Ù…Ø³Ø§Ø±Ø§Øªâ€¦) */
const bannedWords = [
  "Ù…ØªÙˆØ³Ø·","Ø«Ø§Ù†ÙˆÙŠ","Ù…Ø³Ø§Ø±Ø§Øª","Ø£ÙˆÙ„Ù‰","Ø«Ø§Ù†ÙŠØ©","Ø«Ø§Ù„Ø«Ø©",
  "Ø§Ù„Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ","Ø§Ù„Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ","Ø§Ù„Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ",
  "ØªØ­ÙÙŠØ¸","Ø£Ø­ÙŠØ§Ø¡","ÙÙŠØ²ÙŠØ§Ø¡","ÙƒÙŠÙ…ÙŠØ§Ø¡","ØªÙˆØ­ÙŠØ¯",
  "Ù‚Ø±Ø§Ø¡Ø©","Ø­Ø¯ÙŠØ«","ÙÙ‚Ù‡","Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",
  "Ù…Ø¨Ø§Ø´Ø±","Ù„Ø§ÙŠÙ","ØªÙ†ÙˆÙŠÙ‡","Ø¥Ø¹Ù„Ø§Ù†",
  "Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ","Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù„Ø«"
];

/* ØªØ­ÙˆÙŠÙ„ Ù…Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
function parseDuration(iso) {
  const m = iso.match(/PT(\d+M)?(\d+S)?/);
  const min = m[1] ? parseInt(m[1]) : 0;
  const sec = m[2] ? parseInt(m[2]) : 0;
  return min * 60 + sec;
}

/* Ø¨Ù†Ø§Ø¡ Ù†Øµ Ø§Ù„Ø¨Ø­Ø« */
function buildQuery(text, grade, subject) {
  let q = text;
  if (subject) q += " " + subject;
  if (grade) q += " Ø§Ù„ØµÙ " + grade + " Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ ";
  q += " Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„ ";
  return q;
}

/* Ø¬Ù„Ø¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø© */
async function getDurations(ids) {
  const url = `https://www.googleapis.com/youtube/v3/videos?part=contentDetails&id=${ids.join(",")}&key=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();

  const durations = {};
  data.items.forEach(v => {
    durations[v.id] = parseDuration(v.contentDetails.duration);
  });

  return durations;
}

/* Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙŠÙˆØªÙŠÙˆØ¨ */
async function searchYouTube(text) {
  const grade = gradeSelect.value;
  const subject = subjectSelect.value;

  const q = buildQuery(text, grade, subject);

  const url = `https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&channelId=${CHANNEL_ID}&part=snippet&type=video&maxResults=25&q=${encodeURIComponent(q)}`;

  const res = await fetch(url);
  const data = await res.json();
  if (!data.items) return [];

  /* IDs Ù„Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¯Ø© */
  const ids = data.items.map(x => x.id.videoId);
  const durations = await getDurations(ids);

  /* Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù‚ÙˆÙŠØ© */
  return data.items.filter(item => {
    const title = item.snippet.title;
    const vid = item.id.videoId;

    /* Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ Ø§Ù„Ù‚ØµÙŠØ±Ø© */
    if (durations[vid] < 20) return false;

    /* Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…Ù…Ù†ÙˆØ¹Ø© */
    for (let w of bannedWords) {
      if (title.includes(w)) return false;
    }

    /* ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¹Ù„Ù‰ Ø§Ù„ØµÙ */
    const grade = gradeSelect.value;
    if (grade && !title.includes(grade)) return false;

    return true;
  }).map(item => ({
    title: item.snippet.title,
    videoId: item.id.videoId
  }));
}

/* Ø§Ù„Ø¨Ø­Ø« */
let timer;
searchInput.addEventListener("input", () => {
  clearTimeout(timer);
  if (!searchInput.value.trim()) {
    suggestions.style.display = "none";
    return;
  }

  timer = setTimeout(async () => {
    const list = await searchYouTube(searchInput.value.trim());
    suggestions.innerHTML = "";
    if (list.length === 0) return suggestions.style.display = "none";

    list.slice(0, 8).forEach(i => {
      const div = document.createElement("div");
      div.className = "suggestion-item";
      div.textContent = i.title;
      div.onclick = () => {
        searchInput.value = i.title;
        suggestions.style.display = "none";
        showResults([i]);
        playVideo(i);
      };
      suggestions.appendChild(div);
    });

    suggestions.style.display = "block";
  }, 500);
});

/* Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø« */
searchBtn.onclick = async () => {
  const list = await searchYouTube(searchInput.value.trim());
  showResults(list);
};

/* Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
function showResults(list) {
  resultsList.innerHTML = "";
  list.forEach(i => {
    const div = document.createElement("div");
    div.className = "result-item";
    div.textContent = i.title;
    div.onclick = () => playVideo(i);
    resultsList.appendChild(div);
  });
}

/* ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
function playVideo(i) {
  videoTitle.textContent = i.title;
  videoFrame.src = `https://www.youtube.com/embed/${i.videoId}`;
  videoPlayer.style.display = "block";
  videoPlayer.scrollIntoView({behavior:"smooth"});
}
</script>

</body>
</html>
